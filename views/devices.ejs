<!DOCTYPE HTML>
<html>
  <head>
    <title>Block Chain</title>
    <link rel="stylesheet" href="css/devices.css" />
    <meta name="viewport" content="width=device-width, user-scalable=no
      initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0" />
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.3/jquery.min.js"></script>
      <script>
      function requestMyDeviceList(){
        // var device_name_chk =  $("#device_name").val();
        var userAddress;// = null;

        if (typeof(Storage) !== "undefined") {    // 사용자 address 추출하여 연결하는 부분
            var myJSONwithObject = JSON.parse(JSON.parse(localStorage.getItem("myJSONSecretKey")));
            console.log("myJSONwithObject : ",myJSONwithObject);
            console.log("myJSONwithObject.address : ",myJSONwithObject.address);
            userAddress =  myJSONwithObject.address;
        } else {
            allert("Sorry, your browser does not support Web Storage...");
            return;
        }

        var xmlhttp = new XMLHttpRequest();
        xmlhttp.onreadystatechange = function() {
          if (this.readyState == 4 && this.status == 200) {

            console.log("this.responseText : ", this.responseText);
            //내 장비목록을 가져왔으므로 표현은 영균이가 ~~
          }
        }
        xmlhttp.open("POST", "/requestAllDeviceList", true);  //true Asyc, false syc
        xmlhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
        xmlhttp.send("userAddress="+userAddress);
      };

        function requestAllDeviceList(){
          // var device_name_chk =  $("#device_name").val();
          // var device_purpose_chk =  $("#device_purpose").val();
          // var device_tele_chk =  $("#device_tele").val();
          var userAddress;// = null;

          if (typeof(Storage) !== "undefined") {    // 사용자 address 추출하여 연결하는 부분
              var myJSONwithObject = JSON.parse(JSON.parse(localStorage.getItem("myJSONSecretKey")));
              console.log("myJSONwithObject : ",myJSONwithObject);
              console.log("myJSONwithObject.address : ",myJSONwithObject.address);
              userAddress =  myJSONwithObject.address;
          } else {
              allert("Sorry, your browser does not support Web Storage...");
              return;
          }

          var xmlhttp = new XMLHttpRequest();
          xmlhttp.onreadystatechange = function() {
            if (this.readyState == 4 && this.status == 200) {

              console.log("this.responseText : ", this.responseText);
              //전체 장비목록을 가져왔으므로 표현은 영균이가 ~~
            }
          }
          xmlhttp.open("POST", "/requestAllDeviceList", true);  //true Asyc, false syc
          xmlhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
          xmlhttp.send("userAddress="+userAddress);
        }
  </script>
  </head>
  <body>
    <header>
      <input type="checkbox" id="menu-bar" />
      <label for="menu-bar"><span></span></label>


      <button  id="id_requestMyDeviceList" onclick='requestMyDeviceList()' ><h2>내 장치목록 가져오기</h2></button>
      <button  id="id_requestAllDeviceList" onclick='requestAllDeviceList()' ><h2>등록된 전체 장치목록 가져오기</h2></button>


      <nav>
        <div class="user_info">
          <div class="img-wrap">
            <img src="img/profile_face2.jpg" />
          </div>
          <div class="profile">
            <p class="username">Alexander Great</p>
            <p class="user_detail">Administrator</p>
            <img src="img/icon-setting.svg" class="icon-setting" />
          </div>
        </div>
        <div class="menu-container">
          <a href="./devices">Devices</a>
          <a href="#">Reservation</a>
          <a href="#">Users</a>
          <a href="./main">History</a>
        </div>
      </nav>
      <label for="menu-bar" class="overlay"></label>
    </header>

    <div class="content">
      <div class="devices-list" id="list-1">
        <div class="devices-img">
          <img src="img/icon-airconditioner2.svg" />
        </div>
        <div class="devices-detail">
          <p class="device-name">Air Conditioner</p>
          <p class="device-info">
            <img src="img/icon-people.svg" />13
            <span class="connected"></span>
          </p>
        </div>
      </div>
      <div class="devices-list">
        <div class="devices-img">
          <img src="img/icon-light2.svg" />
        </div>
        <div class="devices-detail">
          <p class="device-name">Room Light</p>
          <p class="device-info">
            <img src="img/icon-people.svg" />15
            <span class="disconnected"></span>
          </p>
        </div>
      </div>




      <div class="addButton">
        <span></span>
      </div>
    </div>
    <script>
      var temp = document.querySelector('.addButton');
      var list1 = document.querySelector('#list-1');
      temp.addEventListener('click',function(){
        location.href="./device_add";
      })
      list1.addEventListener('click',function(){

        location.href="./device_detail";
      })
    </script>
  </body>
</html>
